<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Account</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="stylee.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    .portfolio-list {
      max-height: 300px;
      overflow-y: auto;
      margin-top: 10px;
    }

    .portfolio-card {
      display: flex;
      justify-content: space-between;
      border: 1px solid white;
      padding: 10px;
      margin-bottom: 8px;
      border-radius: 8px;
      font-size: 14px;
    }
  </style>
</head>

<body class="bg bg-account">

<div class="account-page">

  <div class="profile-section">
    <div class="avatar">
      <img src="images/avatar.png" alt="Avatar">
    </div>

    <div>
      <p id="username"></p>
      <p id="email"></p>
      <p id="inviteCode"></p>
    </div>

    <button onclick="logout()">Logout</button>
  </div>

  <hr>

  <div class="portfolio">
    <h2>My work portfolio</h2>
    <div class="portfolio-list" id="portfolioList"></div>
  </div>

</div>

<nav class="bottom-nav">
  <a href="home.html"><i class="fas fa-house"></i><span>Home</span></a>
  <a href="review.html"><i class="fas fa-star"></i><span>Reviews</span></a>
  <a href="account.html" class="active"><i class="fas fa-user"></i><span>Account</span></a>
</nav>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const user = JSON.parse(localStorage.getItem("user"));

  // ðŸ”’ If user not logged in
  if (!user) {
    location.href = "index.html";
    return;
  }

  // âœ… Set profile info
  document.getElementById("username").innerText = user.fullName || "";
  document.getElementById("email").innerText = user.email || "";
  document.getElementById("inviteCode").innerText =
    "Invitation Code: " + (user.inviteCode || "N/A");

  // ðŸ”‘ USER-SPECIFIC PORTFOLIO KEY
  const portfolioKey = `portfolio_${user.email}`;
  const portfolio = JSON.parse(localStorage.getItem(portfolioKey)) || [];

  const list = document.getElementById("portfolioList");

  if (!portfolio.length) {
    list.innerHTML = "<p>No work added yet</p>";
    return;
  }

  portfolio.forEach(item => {
    const div = document.createElement("div");
    div.className = "portfolio-card";
    div.innerHTML = `
      <span>${item.hotel}</span>
      <span>${item.action}</span>
      <span>${item.time}</span>
      <span>${item.profit}</span>
    `;
    list.appendChild(div);
  });
});

// ðŸšª SAFE LOGOUT
function logout() {
  localStorage.setItem("loggedIn", "false");
  location.href = "index.html";
}

</script>

</body>
</html>
